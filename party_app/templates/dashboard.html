<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>PartySense</title>
  <link rel="stylesheet" href="/static/css/styles.css">
  <link rel="preload" href="/static/lottie/gradient2.json" as="fetch" type="application/json" crossorigin="anonymous">
  <!-- ĞŸĞ¾Ğ¿ĞµÑ€ĞµĞ´Ğ½Ñ” Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ Lottie.js -->
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.9.6/lottie.min.js"
    referrerpolicy="no-referrer">
  </script>
</head>

<body>
  <!-- ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸ Ğ· Ñ„Ñ–ĞºÑĞ¾Ğ²Ğ°Ğ½Ğ¸Ğ¼Ğ¸ Ñ€Ğ¾Ğ·Ğ¼Ñ–Ñ€Ğ°Ğ¼Ğ¸ Ğ´Ğ»Ñ Ğ°Ğ½Ñ–Ğ¼Ğ°Ñ†Ñ–Ñ— -->
  <div id="lottie-container"></div>
  <div id="lottie-container-bottom"></div>

  <!-- ĞœĞµĞ½Ñ Ğ¿Ñ€Ğ¾Ñ„Ñ–Ğ»Ñ Ñƒ Ğ¿Ñ€Ğ°Ğ²Ğ¾Ğ¼Ñƒ Ğ²ĞµÑ€Ñ…Ğ½ÑŒĞ¾Ğ¼Ñƒ ĞºÑƒÑ‚Ñ– -->
  <header id="top-bar">
    <div id="profile-menu" class="profile-menu">
      <span id="profile-username">{{ user }}</span>
      <img src="/static/img/logo.png" alt="" id="logo-icon" class="logo-icon">
      <div id="profile-dropdown" class="profile-dropdown">
        <div class="pref-item">
          <span class="pref-icon">ğŸ’¡</span>
          <select id="led-mode-select">
            <option value="default" {% if preferences.led_mode == "default" %}selected{% endif %}>Default</option>
            <option value="party"   {% if preferences.led_mode == "party"   %}selected{% endif %}>Party</option>
            <option value="chill"   {% if preferences.led_mode == "chill"   %}selected{% endif %}>Chill</option>
          </select>
        </div>
        <div class="pref-item">
          <span class="pref-icon">ğŸš¶</span>
          <input
            type="checkbox"
            id="motion-detection-toggle"
            {% if preferences.motion_detection %}checked{% endif %}
          >
        </div>
        <a href="/logout" id="logout-btn">Logout</a>
      </div>
    </div>
  </header>

  <!-- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑƒĞ»ÑĞ±Ğ»ĞµĞ½Ğ¸Ñ… -->
  <section id="favorites-section">
    <h2>Your Favorites</h2>
    <ul id="favorites-list">
      {% for song in favorites %}
      <li class="favorite-item"
          data-video-id="{{ song.video_id }}"
          data-title="{{ song.title }}"
          data-thumbnail="{{ song.thumbnail_url }}"
          data-duration="{{ song.duration }}"
      >
        <span class="song-title">{{ song.title }}</span>
        <button class="heart-btn">â™¥</button>
        <button class="play-btn">Play</button>
      </li>
      {% endfor %}
    </ul>
  </section>

  <!-- ĞŸĞ¾ÑˆÑƒĞº -->
  <div id="search-container">
    <input type="text" id="search" placeholder="Enter song or artist" autocomplete="off">
    <button class="search-button">Search</button>
    <ul id="autocomplete-suggestions"></ul>
  </div>

  <!-- Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¸ Ğ¿Ğ¾ÑˆÑƒĞºÑƒ -->
  <div id="search-results">
    <div id="results-grid" class="results-grid"></div>
    <div id="loading" style="display:none;">Loading...</div>
  </div>

  <!-- ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ²Ğ°Ñ‡ -->
  <section id="playback-status">
    <h2><span id="current-song-title">N/A</span></h2>

    <div id="playback-controls">
      <button id="btn-shuffle" class="playback-btn">ğŸ”€</button>
      <button id="btn-prev" class="playback-btn">â®</button>
      <button id="btn-play-pause" class="playback-btn">â–¶</button>
      <button id="btn-next" class="playback-btn">â­</button>
      <button id="btn-repeat" class="playback-btn">ğŸ”</button>
    </div>

    <div id="playback-progress-container">
      <button id="current-heart-btn">â™¡</button>

      <!-- ĞŸĞ¾Ñ‡Ğ°Ñ‚ĞºĞ¾Ğ²Ñ– Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ 0:00 -->
      <span id="prog-start">0:00</span>
      <input type="range" id="playback-progress" min="0" value="0" step="0.1">
      <span id="prog-end">0:00</span>

      <div class="volume-wrapper">
        <span id="volume-icon" class="volume-icon">ğŸ”Š</span>
        <div id="volume-slider-container" class="volume-slider-container">
          <input
            type="range"
            id="volume-slider"
            min="0"
            max="100"
            step="1"
            value="{{ (preferences.volume * 100) | int }}"
          >
        </div>
      </div>
    </div>
  </section>

  <!-- Socket.IO + JS -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js" crossorigin="anonymous"></script>
  <script type="module" src="/static/js/main.js"></script>
</body>
</html>